trigger:
  - main

pool:
  name: default

steps:
- task: Docker@2
  displayName: Frontend Docker Build
  inputs:
    containerRegistry: 'harbor-registry'
    repository: '/p1/frontend'
    command: 'buildAndPush'
    Dockerfile: 'frontend/Dockerfile'
    buildContext: 'frontend'
    tags: |
      latest
      $(Build.BuildId)
- task: Docker@2
  displayName: Backend Docker Build
  inputs:
    containerRegistry: 'harbor-registry'
    repository: '/p1/backend'
    command: 'buildAndPush'
    Dockerfile: 'restapi/Dockerfile'
    buildContext: 'restapi'
    tags: |
      latest
      $(Build.BuildId)
- task: Docker@2
  displayName: Static Host Docker Build
  inputs:
    containerRegistry: 'harbor-registry'
    repository: '/p1/static'
    command: 'buildAndPush'
    Dockerfile: 'static-host/Dockerfile'
    buildContext: 'static-host'
    tags: |
      latest
      $(Build.BuildId)